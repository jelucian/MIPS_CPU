`timescale 1ns / 1ps
/********************************************************************************
 *
 * Author:   Jesus Luciano & Rosswell Tiongco
 * Filename: SHIFT.v
 * Date:     3/21/2019
 * Version:  1.0
 * 
 * Notes:    
 *
 *
 *******************************************************************************/
module SHIFT(T, FS, shamt, V, C, Y_hi, Y_lo);
    
    input [ 4:0] FS, shamt;
    input [31:0] T;
    
    output reg V, C;
    output reg [31:0] Y_hi, Y_lo;
    
    parameter SRL = 5'h0C, SRA  = 5'h0D, SLL  = 5'h0E;

    always @(*) 
    begin
    V = 1'hx;//Never overflow on a shift
    Y_lo = 32'h0;//Y_hi always zero on a shift
      case(FS)
        SRL://Shift Right Logical 
          begin
           case(shamt)
             5'h01 : {C, Y_lo} = {T[ 0], { 1{1'b0}}, T[31: 1] };
             5'h02 : {C, Y_lo} = {T[ 1], { 2{1'b0}}, T[31: 2] };     
             5'h03 : {C, Y_lo} = {T[ 2], { 3{1'b0}}, T[31: 3] };  
             5'h04 : {C, Y_lo} = {T[ 3], { 4{1'b0}}, T[31: 4] }; 
             5'h05 : {C, Y_lo} = {T[ 4], { 5{1'b0}}, T[31: 5] }; 
             5'h06 : {C, Y_lo} = {T[ 5], { 6{1'b0}}, T[31: 6] }; 
             5'h07 : {C, Y_lo} = {T[ 6], { 7{1'b0}}, T[31: 7] }; 
             5'h08 : {C, Y_lo} = {T[ 7], { 8{1'b0}}, T[31: 8] }; 
             5'h09 : {C, Y_lo} = {T[ 8], { 9{1'b0}}, T[31: 9] }; 
             5'h0A : {C, Y_lo} = {T[ 9], {10{1'b0}}, T[31:10] }; 
             5'h0B : {C, Y_lo} = {T[10], {11{1'b0}}, T[31:11] }; 
             5'h0C : {C, Y_lo} = {T[11], {12{1'b0}}, T[31:12] }; 
             5'h0D : {C, Y_lo} = {T[12], {13{1'b0}}, T[31:13] }; 
             5'h0E : {C, Y_lo} = {T[13], {14{1'b0}}, T[31:14] }; 
             5'h0F : {C, Y_lo} = {T[14], {15{1'b0}}, T[31:15] }; 
             5'h10 : {C, Y_lo} = {T[15], {16{1'b0}}, T[31:16] }; 
             5'h11 : {C, Y_lo} = {T[16], {17{1'b0}}, T[31:17] }; 
             5'h12 : {C, Y_lo} = {T[17], {18{1'b0}}, T[31:18] }; 
             5'h13 : {C, Y_lo} = {T[18], {19{1'b0}}, T[31:19] }; 
             5'h14 : {C, Y_lo} = {T[19], {20{1'b0}}, T[31:20] }; 
             5'h15 : {C, Y_lo} = {T[20], {21{1'b0}}, T[31:21] }; 
             5'h16 : {C, Y_lo} = {T[21], {22{1'b0}}, T[31:22] }; 
             5'h17 : {C, Y_lo} = {T[22], {23{1'b0}}, T[31:23] }; 
             5'h18 : {C, Y_lo} = {T[23], {24{1'b0}}, T[31:24] }; 
             5'h19 : {C, Y_lo} = {T[24], {25{1'b0}}, T[31:25] }; 
             5'h1A : {C, Y_lo} = {T[25], {26{1'b0}}, T[31:26] }; 
             5'h1B : {C, Y_lo} = {T[26], {27{1'b0}}, T[31:27] }; 
             5'h1C : {C, Y_lo} = {T[27], {28{1'b0}}, T[31:28] }; 
             5'h1D : {C, Y_lo} = {T[28], {29{1'b0}}, T[31:29] }; 
             5'h1E : {C, Y_lo} = {T[29], {30{1'b0}}, T[31:30] }; 
             5'h1F : {C, Y_lo} = {T[30], {31{1'b0}}, T[31:31] }; 
            default: {C, Y_lo} = { 1'b0, T[31:0]};//no shift  
           endcase
          end
        SRA://Shift Right Arithmetic
          begin
           case(shamt)
             5'h01 : {C, Y_lo} = {T[ 0], { 1{T[31]}}, T[31: 1] }; 
             5'h02 : {C, Y_lo} = {T[ 1], { 2{T[31]}}, T[31: 2] };
             5'h03 : {C, Y_lo} = {T[ 2], { 3{T[31]}}, T[31: 3] };
             5'h04 : {C, Y_lo} = {T[ 3], { 4{T[31]}}, T[31: 4] };
             5'h05 : {C, Y_lo} = {T[ 4], { 5{T[31]}}, T[31: 5] };
             5'h06 : {C, Y_lo} = {T[ 5], { 6{T[31]}}, T[31: 6] };
             5'h07 : {C, Y_lo} = {T[ 6], { 7{T[31]}}, T[31: 7] };
             5'h08 : {C, Y_lo} = {T[ 7], { 8{T[31]}}, T[31: 8] };
             5'h09 : {C, Y_lo} = {T[ 8], { 9{T[31]}}, T[31: 9] };
             5'h0A : {C, Y_lo} = {T[ 9], {10{T[31]}}, T[31:10] };
             5'h0B : {C, Y_lo} = {T[10], {11{T[31]}}, T[31:11] };
             5'h0C : {C, Y_lo} = {T[11], {12{T[31]}}, T[31:12] };
             5'h0D : {C, Y_lo} = {T[12], {13{T[31]}}, T[31:13] };
             5'h0E : {C, Y_lo} = {T[13], {14{T[31]}}, T[31:14] };
             5'h0F : {C, Y_lo} = {T[14], {15{T[31]}}, T[31:15] };
             5'h10 : {C, Y_lo} = {T[15], {16{T[31]}}, T[31:16] };
             5'h11 : {C, Y_lo} = {T[16], {17{T[31]}}, T[31:17] };
             5'h12 : {C, Y_lo} = {T[17], {18{T[31]}}, T[31:18] };
             5'h13 : {C, Y_lo} = {T[18], {19{T[31]}}, T[31:19] };
             5'h14 : {C, Y_lo} = {T[19], {20{T[31]}}, T[31:20] };
             5'h15 : {C, Y_lo} = {T[20], {21{T[31]}}, T[31:21] };
             5'h16 : {C, Y_lo} = {T[21], {22{T[31]}}, T[31:22] };
             5'h17 : {C, Y_lo} = {T[22], {23{T[31]}}, T[31:23] };
             5'h18 : {C, Y_lo} = {T[23], {24{T[31]}}, T[31:24] };
             5'h19 : {C, Y_lo} = {T[24], {25{T[31]}}, T[31:25] };
             5'h1A : {C, Y_lo} = {T[25], {26{T[31]}}, T[31:26] };
             5'h1B : {C, Y_lo} = {T[26], {27{T[31]}}, T[31:27] };
             5'h1C : {C, Y_lo} = {T[27], {28{T[31]}}, T[31:28] };
             5'h1D : {C, Y_lo} = {T[28], {29{T[31]}}, T[31:29] };
             5'h1E : {C, Y_lo} = {T[29], {30{T[31]}}, T[31:30] };
             5'h1F : {C, Y_lo} = {T[30], {31{T[31]}}, T[31:31] };
            default: {C, Y_lo} = { 1'b0, T[31:0]};//no shift 
           endcase 
          end
        SLL://Shift Left Logial
          begin
           case(shamt)
             5'h01 : {C, Y_lo} = { T[31], T[30:0], { 1{1'b0}} };
             5'h02 : {C, Y_lo} = { T[30], T[29:0], { 2{1'b0}} };
             5'h03 : {C, Y_lo} = { T[29], T[28:0], { 3{1'b0}} };
             5'h04 : {C, Y_lo} = { T[28], T[27:0], { 4{1'b0}} };
             5'h05 : {C, Y_lo} = { T[27], T[26:0], { 5{1'b0}} };
             5'h06 : {C, Y_lo} = { T[26], T[25:0], { 6{1'b0}} };
             5'h07 : {C, Y_lo} = { T[25], T[24:0], { 7{1'b0}} };
             5'h08 : {C, Y_lo} = { T[24], T[23:0], { 8{1'b0}} };
             5'h09 : {C, Y_lo} = { T[23], T[22:0], { 9{1'b0}} };
             5'h0A : {C, Y_lo} = { T[22], T[21:0], {10{1'b0}} };
             5'h0B : {C, Y_lo} = { T[21], T[20:0], {11{1'b0}} };
             5'h0C : {C, Y_lo} = { T[20], T[19:0], {12{1'b0}} };
             5'h0D : {C, Y_lo} = { T[19], T[18:0], {13{1'b0}} };
             5'h0E : {C, Y_lo} = { T[18], T[17:0], {14{1'b0}} };
             5'h0F : {C, Y_lo} = { T[17], T[16:0], {15{1'b0}} };
             5'h10 : {C, Y_lo} = { T[16], T[15:0], {16{1'b0}} };
             5'h11 : {C, Y_lo} = { T[15], T[14:0], {17{1'b0}} };
             5'h12 : {C, Y_lo} = { T[14], T[13:0], {18{1'b0}} };
             5'h13 : {C, Y_lo} = { T[13], T[12:0], {19{1'b0}} };
             5'h14 : {C, Y_lo} = { T[12], T[11:0], {20{1'b0}} };
             5'h15 : {C, Y_lo} = { T[11], T[10:0], {21{1'b0}} };
             5'h16 : {C, Y_lo} = { T[10], T[ 9:0], {22{1'b0}} };
             5'h17 : {C, Y_lo} = { T[ 9], T[ 8:0], {23{1'b0}} };
             5'h18 : {C, Y_lo} = { T[ 8], T[ 7:0], {24{1'b0}} };
             5'h19 : {C, Y_lo} = { T[ 7], T[ 6:0], {25{1'b0}} };
             5'h1A : {C, Y_lo} = { T[ 6], T[ 5:0], {26{1'b0}} };
             5'h1B : {C, Y_lo} = { T[ 5], T[ 4:0], {27{1'b0}} };
             5'h1C : {C, Y_lo} = { T[ 4], T[ 3:0], {28{1'b0}} };
             5'h1D : {C, Y_lo} = { T[ 3], T[ 2:0], {29{1'b0}} };
             5'h1E : {C, Y_lo} = { T[ 2], T[ 1:0], {30{1'b0}} };
             5'h1F : {C, Y_lo} = { T[ 1], T[ 0:0], {31{1'b0}} };
            default: {C, Y_lo} = {  1'b0, T[31:0] };//no shift
           endcase     
          end
        default: {C, Y_lo} = { 1'b0, T[31:0] };//No Shift
      endcase
    end
        
endmodule
